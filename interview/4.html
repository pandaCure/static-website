<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>javascript String ç±»å‹ | é’Ÿç¹‡</title>
    <meta name="description" content="JavaScriptçŸ¥è¯†ç‚¹">
    <meta name="generator" content="VuePress 1.4.0">
    <link rel="icon" href="/static-website/logo.png">
  <link rel="manifest" href="/static-website/manifest.json">
  <meta name="theme-color" content="#3eaf7c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/static-website/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/static-website/icons/safari-pinned-tab.svg" color="#3eaf7c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/static-website/assets/css/0.styles.57852ca5.css" as="style"><link rel="preload" href="/static-website/assets/js/app.8f4c87ad.js" as="script"><link rel="preload" href="/static-website/assets/js/2.1f517c06.js" as="script"><link rel="preload" href="/static-website/assets/js/13.85a9c570.js" as="script"><link rel="prefetch" href="/static-website/assets/js/10.4d784bf9.js"><link rel="prefetch" href="/static-website/assets/js/11.74ce90d6.js"><link rel="prefetch" href="/static-website/assets/js/12.611f1fe9.js"><link rel="prefetch" href="/static-website/assets/js/14.6e958ccc.js"><link rel="prefetch" href="/static-website/assets/js/15.e3bd749c.js"><link rel="prefetch" href="/static-website/assets/js/16.83d172a2.js"><link rel="prefetch" href="/static-website/assets/js/17.3486be53.js"><link rel="prefetch" href="/static-website/assets/js/18.6f516d6c.js"><link rel="prefetch" href="/static-website/assets/js/19.4d538a11.js"><link rel="prefetch" href="/static-website/assets/js/20.a334c17c.js"><link rel="prefetch" href="/static-website/assets/js/21.2b42e65e.js"><link rel="prefetch" href="/static-website/assets/js/22.ce8766c0.js"><link rel="prefetch" href="/static-website/assets/js/23.48ff6209.js"><link rel="prefetch" href="/static-website/assets/js/3.455a7035.js"><link rel="prefetch" href="/static-website/assets/js/4.6e96a130.js"><link rel="prefetch" href="/static-website/assets/js/5.cbd0f1fd.js"><link rel="prefetch" href="/static-website/assets/js/6.8b5122f1.js"><link rel="prefetch" href="/static-website/assets/js/7.353fc449.js"><link rel="prefetch" href="/static-website/assets/js/8.c6d52a50.js"><link rel="prefetch" href="/static-website/assets/js/9.95ebbbc2.js">
    <link rel="stylesheet" href="/static-website/assets/css/0.styles.57852ca5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/static-website/" class="home-link router-link-active"><!----> <span class="site-name">é’Ÿç¹‡</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/static-website/" class="nav-link">
  ä¸»é¡µ
</a></div><div class="nav-item"><a href="/static-website/topics/" class="nav-link">
  çŸ¥è¯†ç‚¹
</a></div><div class="nav-item"><a href="/static-website/just-javascript/" class="nav-link">
  Just Javascriptå¯¹ç…§ç¿»è¯‘
</a></div><div class="nav-item"><a href="/static-website/interview/" class="nav-link router-link-active">
  é¢è¯•é¢˜
</a></div><div class="nav-item"><a href="/static-website/origin/" class="nav-link">
  æºç ç³»åˆ—
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/static-website/" class="nav-link">
  ä¸»é¡µ
</a></div><div class="nav-item"><a href="/static-website/topics/" class="nav-link">
  çŸ¥è¯†ç‚¹
</a></div><div class="nav-item"><a href="/static-website/just-javascript/" class="nav-link">
  Just Javascriptå¯¹ç…§ç¿»è¯‘
</a></div><div class="nav-item"><a href="/static-website/interview/" class="nav-link router-link-active">
  é¢è¯•é¢˜
</a></div><div class="nav-item"><a href="/static-website/origin/" class="nav-link">
  æºç ç³»åˆ—
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>é¢è¯•é¢˜</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/static-website/interview/1.html" class="sidebar-link">0.1 + 0.2 === 0.3?</a></li><li><a href="/static-website/interview/2.html" class="sidebar-link">æ‰‹å†™Promise</a></li><li><a href="/static-website/interview/3.html" class="sidebar-link">å…³äºBigInt</a></li><li><a href="/static-website/interview/4.html" class="active sidebar-link">javascript String ç±»å‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/static-website/interview/4.html#å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯¹åº”çš„-unicode-ç¼–ç " class="sidebar-link">å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯¹åº”çš„ Unicode ç¼–ç </a></li><li class="sidebar-sub-header"><a href="/static-website/interview/4.html#unicode" class="sidebar-link">Unicode</a></li><li class="sidebar-sub-header"><a href="/static-website/interview/4.html#ä»£ç†å¯¹ï¼ˆsurrogate-pairï¼‰" class="sidebar-link">ä»£ç†å¯¹ï¼ˆsurrogate pairï¼‰</a></li><li class="sidebar-sub-header"><a href="/static-website/interview/4.html#å®ç°-getcodepoint" class="sidebar-link">å®ç° getCodePoint</a></li><li class="sidebar-sub-header"><a href="/static-website/interview/4.html#getcodepointcount" class="sidebar-link">getCodePointCount</a></li><li class="sidebar-sub-header"><a href="/static-website/interview/4.html#æ‰©å±•" class="sidebar-link">æ‰©å±•</a></li><li class="sidebar-sub-header"><a href="/static-website/interview/4.html#æ–‡çŒ®" class="sidebar-link">æ–‡çŒ®</a></li><li class="sidebar-sub-header"><a href="/static-website/interview/4.html#surrogate-pair" class="sidebar-link">surrogate pair</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="javascript-string-ç±»å‹"><a href="#javascript-string-ç±»å‹" class="header-anchor">#</a> javascript String ç±»å‹</h1> <p>åœ¨ JavaScript ä¸­å¤„ç†ä¸­æ–‡å’Œå…¶ä»– Unicode å­—ç¬¦æ—¶ï¼Œæˆ‘ä»¬ä¼šç”¨åˆ°å¤„ç† Unicode ç›¸å…³çš„ APIã€‚</p> <p>åœ¨æ—©æœŸï¼ŒJavaScript æä¾›çš„ String.prototype.charCodeAt å’Œ String.fromCharCode å°±æ˜¯èƒ½å¤Ÿå°†å­—ç¬¦ä¸²è½¬æ¢ä¸º Unicode çš„ UTF-16 ç¼–ç ä»¥åŠä» UTF-16 ç¼–ç è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„å‡½æ•°ã€‚</p> <h2 id="å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯¹åº”çš„-unicode-ç¼–ç "><a href="#å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯¹åº”çš„-unicode-ç¼–ç " class="header-anchor">#</a> å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯¹åº”çš„ Unicode ç¼–ç </h2> <p>æ¯”å¦‚ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>const str = 'ä¸­æ–‡';

console.log([...str].map(char =&gt; char.charCodeAt(0)));
// [20013, 25991]
</code></pre></div><p>è¿™é‡Œæˆ‘ä»¬å°†å­—ç¬¦ä¸²å±•å¼€æˆå•ä¸ªå­—ç¬¦ï¼Œå†é€šè¿‡ charCodeAt æ–¹æ³•å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯¹åº”çš„ Unicode ç¼–ç ï¼Œè¿™é‡Œçš„ 20013 å’Œ 25991 å°±æ˜¯â€œä¸­æ–‡â€ä¸¤ä¸ªå­—å¯¹åº”çš„ Unicode ç¼–ç ã€‚</p> <p>åŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ fromCharCode å°† Unicode ç¼–ç è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>const charCodes = [20013, 25991];

console.log(String.fromCharCode(...charCodes)); // ä¸­æ–‡
</code></pre></div><p>è¿™ä¸¤ä¸ªæ–¹æ³•ç›¸ä¿¡å¤§éƒ¨åˆ†åŒå­¦éƒ½ä¸é™Œç”Ÿï¼Œè¿™æ˜¯ä» ES3 å°±å¼€å§‹æ”¯æŒçš„æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨ä»Šå¤©æˆ‘ä»¬å¤„ç† Unicode å­—ç¬¦æ—¶ä¸å¤Ÿç”¨äº†ã€‚</p> <p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä¾‹å­ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>const str = 'ğŸ€„';

console.log(str.charCodeAt(0)); // 55356
</code></pre></div><p>è¿™ä¸ªå­—ç¬¦æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„éº»å°†ä¸­çš„çº¢ä¸­ï¼Œç°åœ¨å¾ˆå¤šè¾“å…¥æ³•éƒ½èƒ½ç›´æ¥æ‰“å‡ºæ¥ï¼Œçœ‹ä¸Šå»ä¼¼ä¹ä¹Ÿæ­£å¸¸ï¼Œæ²¡ä»€ä¹ˆé—®é¢˜å•Šï¼Ÿ</p> <p>å¯ä½ å†è¯•è¯•ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>console.log(String.fromCharCode(55356)); // ï¿½
</code></pre></div><p>å®é™…ä¸Š Unicode å­—ç¬¦ ğŸ€„ çš„ UTF-16 ç¼–ç å¹¶ä¸æ˜¯ 55356ï¼Œè¿™æ—¶å€™å¦‚æœä½ ä½¿ç”¨ charCodeAt æ¥å¾—åˆ°å­—ç¬¦ ğŸ€„ çš„ UTF-16 ç¼–ç ï¼Œåº”è¯¥è¦åˆ°ä¸¤ä¸ªå€¼ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>const str = 'ğŸ€„';

console.log(str.charCodeAt(0), str.charCodeAt(1)); // 55356 56324
</code></pre></div><p>å¯¹åº”çš„ String.fromCharCode(55356, 56324)æ‰èƒ½è¿˜åŸ ğŸ€„ å­—ç¬¦ã€‚</p> <p>é™¤æ­¤ä»¥å¤–ï¼Œè¿˜æœ‰å…¶ä»–ä¸€äº›ä¸ä¸€æ ·çš„åœ°æ–¹ï¼Œæ¯”å¦‚ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>console.log('ğŸ€„'.length); // å­—ç¬¦ä¸²é•¿åº¦ä¸º2
'ğŸ€„'.split(''); // [&quot;ï¿½&quot;, &quot;ï¿½&quot;] split å‡ºæ¥ä¸¤ä¸ªå­—ç¬¦
/^.$/.test('ğŸ€„'); // false
</code></pre></div><p>æ‰€ä»¥æˆ‘ä»¬ä» Unicode è¯´èµ·ã€‚ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œæˆ‘ä»¬éƒ½åº”è¯¥æˆ–å¤šæˆ–å°‘äº†è§£å…¶ç›¸å…³çŸ¥è¯†ã€‚</p> <p>ä¸–ç•Œä¸Šæœ‰é‚£ä¹ˆå¤šè¯­è¨€ç³»ç»Ÿï¼Œæ¯é—¨è¯­è¨€åˆæœ‰é‚£å¤šæ–‡å­—å­—ç¬¦ã€‚</p> <p>ä¸ºäº†åœ¨è®¡ç®—æœºä¸Šè¡¨ç¤ºè¿™äº›å­—ç¬¦ï¼Œä¸€ä¸ªå¤©ç„¶çš„æƒ³æ³•å°±æ˜¯ç»™æ¯ä¸ªå­—ç¬¦ä¸€ä¸ªç¼–å·ã€‚æŠŠæ¯ä¸€ä¸ªå­—ç¬¦æ˜ å°„æˆä¸€ä¸ªæ•´æ•°ï¼Œè¿™äº›æ•°å­—çš„å­¦åå«ç ä½ï¼ˆcode pointï¼‰ã€‚æ¯”å¦‚ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">'a'</span><span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 97</span>
<span class="token string">'å§š'</span><span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 23002å¤åˆ¶ä»£ç </span>
</code></pre></div><h2 id="unicode"><a href="#unicode" class="header-anchor">#</a> Unicode</h2> <p>ç©¶ç«Ÿå¾—å¤šå°‘ä¸ªç ä½æ‰å¤Ÿå‘¢ï¼Ÿåˆšå¼€å§‹ Unicode è®¾è®¡äººå‘˜è§‰å¾— 2^16 (65536)å°±è¯¥è¶³å¤Ÿäº†ï¼Œäºæ˜¯äº§ç”Ÿäº† UCS-2ã€‚ï¼ˆæ³¨ï¼šäº‹å®ä¸Š Unicode å’Œ UCS åœ¨æœ€å¼€å§‹æ—¶ä¸æ˜¯ä¸€å®¶ã€‚ï¼‰</p> <p>å– 16 æ¬¡æ–¹ï¼Œå³è¯´æ˜ 2 ä¸ªå­—èŠ‚æ•°æ®å°±èƒ½è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦äº†ã€‚è¿™ç§ç¼–ç æ–¹å¼å¤šç®€å•ï¼Œä¸ç®¡æ˜¯ä»æ€§èƒ½è¿˜æ˜¯ä»å®ç°ä¸Šæ¥è¯´ï¼Œéƒ½çœ‹èµ·æ¥æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚å› æ­¤ï¼Œå¾ˆå¤šè¯­è¨€éƒ½é‡‡ç”¨äº† 16 ä½ç¼–ç çš„å­—ç¬¦ä¸²ï¼ŒåŒ…æ‹¬å’±ä»¬çš„ JavaScriptã€‚</p> <p>è™½ç„¶ 6 ä¸‡å¤šä¸ªå­—ç¬¦è¶³ä»¥åŒ…æ‹¬ä¸–ç•Œä¸Šç»å¤§å¤šæ•°å¸¸ç”¨å­—ç¬¦ï¼Œä½†äº‹å®ä¸Šè¿˜æ˜¯ä¸å¤Ÿçš„ï¼ŒUnicode ä¸æ–­æ‰©å±•ã€‚æˆªæ­¢ 2019 å¹´ 3 æœˆï¼Œå·²æ”¶å…¥ 150 ä¸ªä¹¦å†™ç³»ç»Ÿï¼Œå…±è®¡å­—ç¬¦ 137928 çš„ã€‚</p> <p>ç»Ÿä¸€ç”¨ä¸¤ä¸ªå­—èŠ‚æ¥å­˜å‚¨ä¸€ä¸ªå­—ç¬¦ï¼Œè¿™ç§æ–¹å¼ä¸å†ä¸€ç›´æœ‰æ•ˆã€‚å› æ­¤å‡ºç°äº†ä¸åŒçš„ç¼–ç æ ‡å‡†ï¼Œæ¯”å¦‚ UTF-8ã€UTF-16 å’Œ UTF-32ã€‚</p> <p>è¿™é‡Œä¸»è¦è¯´è¯´ä¸ JS ç›¸å…³çš„ UTF-16ã€‚</p> <p>UTF-16 æ˜¯ä¸€ç§å˜é•¿è¡¨ç¤ºï¼Œå®ƒå¯¹æ¥è‡ªå¸¸ç”¨å­—ç¬¦ UCS-2 çš„ç ä½ï¼Œä»ç„¶ç”¨ 2 ä¸ªå­—èŠ‚è¡¨ç¤ºã€‚è€Œå¯¹æ¥æ–°å¢éå¸¸ç”¨çš„ç ä½å´ç”¨ 4 ä¸ªå­—èŠ‚è¡¨ç¤ºã€‚äºŒè€…èƒ½äº’ç›¸åŒºåˆ†å¼€æ¥ï¼Œè¿™æ˜¯ UTF-16 çš„ç²¾å¦™ä¹‹å¤„æ‰€åœ¨ã€‚</p> <p>ğŸ‘‰ğŸ» çŸ¥è¯†ç‚¹ï¼šUnicode æ ‡å‡†ä¸­ï¼Œå°†å­—ç¬¦ç¼–ç çš„ç ä½ä»¥ 2**16 ä¸ªä¸ºä¸€ç»„ï¼Œç»„æˆä¸ºä¸€ä¸ªå¹³é¢ï¼ˆPlaneï¼‰ï¼ŒæŒ‰ç…§å­—ç¬¦çš„ç ä½å€¼ï¼Œåˆ†ä¸º 17 ä¸ªå¹³é¢ï¼Œæ‰€æœ‰ç ä½ä» 0x000000 åˆ° 0x10FFFFï¼Œæ€»å…±ä½¿ç”¨ 3 ä¸ªå­—èŠ‚ã€‚</p> <p>å…¶ä¸­æœ€å‰é¢çš„ 1 ä¸ªå­—èŠ‚æ˜¯å¹³é¢ç¼–å·ï¼Œä» 0x0 åˆ° 0x10ï¼Œä¸€å…± 17 ä¸ªå¹³é¢ã€‚</p> <p>ç¬¬ 0 å·å¹³é¢è¢«ç§°ä¸ºåŸºæœ¬å¤šæ–‡ç§å¹³é¢ï¼ˆBMPï¼ŒBasic Multilingual Planeï¼‰ï¼Œè¿™ä¸ªå¹³é¢çš„æ‰€æœ‰å­—ç¬¦ç ä½åªéœ€è¦ 16 ä½ç¼–ç å•å…ƒå³å¯è¡¨ç¤ºï¼Œæ‰€ä»¥å®ƒä»¬å¯ä»¥ç»§ç»­ä½¿ç”¨ UTF-16 ç¼–ç ã€‚</p> <p>å…¶ä»–çš„å¹³é¢è¢«ç§°ä¸ºè¾…åŠ©å¹³é¢ï¼ˆsupplementary planeï¼‰ï¼Œè¿™äº›å¹³é¢çš„å­—ç¬¦è¢«ç§°ä¸ºå¢è¡¥å­—ç¬¦ï¼Œå®ƒä»¬çš„ç ä½å‡è¶…è¿‡ 16 ä½èŒƒå›´ã€‚</p> <p>ES5 åŠä¹‹å‰çš„ JavaScript çš„ Unicode ç›¸å…³ APIï¼Œåªèƒ½ä»¥ UTF-16 æ¥å¤„ç† BMP çš„å­—ç¬¦ï¼Œæ‰€æœ‰å­—ç¬¦ä¸²çš„æ“ä½œéƒ½æ˜¯åŸºäº 16 ä½ç¼–ç å•å…ƒã€‚</p> <p>å› æ­¤ï¼Œå½“ ğŸ€„ è¿™æ ·çš„å¢è¡¥å­—ç¬¦å‡ºç°æ—¶ï¼Œå¾—åˆ°çš„ç»“æœå°±ä¼šä¸é¢„æœŸä¸ç¬¦ã€‚</p> <p>åœ¨ ES2015 ä¹‹åï¼ŒJavaScript æä¾›äº†æ–°çš„ API æ¥æ”¯æŒ Unicode ç ä½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆä½¿ç”¨ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>const str = 'ğŸ€„';

console.log(str.codePointAt(0)); // 126980
</code></pre></div><p>ğŸ‘‰ğŸ» çŸ¥è¯†ç‚¹ï¼šString.prototype.codePointAt(index) æ–¹æ³•è¿”å›å­—ç¬¦ä¸²æŒ‡å®š index ä½ç½®çš„å­—ç¬¦çš„ Unicode ç ä½ï¼Œä¸æ—§çš„ charCodeAt æ–¹æ³•ç›¸æ¯”ï¼Œå®ƒèƒ½å¤Ÿå¾ˆå¥½åœ°æ”¯æŒå¢è¡¥å­—ç¬¦ã€‚</p> <p>å¯¹åº”åœ°ï¼Œæˆ‘ä»¬æœ‰ String.fromCodePoint æ–¹æ³•å°† CodePoint è½¬ä¸ºå¯¹åº”çš„å­—ç¬¦ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>console.log(String.fromCodePoint(126980)); // ğŸ€„
Unicode è½¬ä¹‰
JavaScriptå­—ç¬¦ä¸²æ”¯æŒUnicodeè½¬ä¹‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨ç ä½çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²åŠ ä¸Šå‰ç¼€\uæ¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œä¾‹å¦‚ï¼š

console.log('\u4e2d\u6587'); // ä¸­æ–‡
0x4e2då’Œ0x6587åˆ†åˆ«æ˜¯20013å’Œ25991çš„åå…­è¿›åˆ¶è¡¨ç¤ºã€‚
</code></pre></div><p>æ³¨æ„ï¼ŒUnicode è½¬ä¹‰ä¸ä»…ä»…å¯ä»¥ç”¨äºå­—ç¬¦ä¸²ï¼Œå®é™…ä¸Š\uxxxx ä¹Ÿæ˜¯å¯ä»¥ç”¨åœ¨æ ‡è¯†ç¬¦ï¼Œå¹¶ç›¸äº’è½¬æ¢çš„ã€‚ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>const \u4e2d\u6587 = 'æµ‹è¯•';

console.log(ä¸­æ–‡); // æµ‹è¯•
</code></pre></div><p>ä¸Šé¢çš„ä»£ç æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªä¸­æ–‡å˜é‡ï¼Œå£°æ˜çš„æ—¶å€™æˆ‘ä»¬ç”¨ Unicode è½¬ä¹‰ï¼Œconsole.log çš„æ—¶å€™ç”¨å®ƒçš„å˜é‡åå­—ç¬¦ï¼Œè¿™æ ·ä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p> <p>\u å’Œåå…­è¿›åˆ¶å­—ç¬¦çš„è¿™ç§è¡¨ç¤ºæ³•åŒæ ·åªé€‚ç”¨äº BMP çš„å­—ç¬¦ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬è¯•å›¾ä½¿ç”¨å®ƒè½¬ä¹‰å¢è¡¥å­—ç¬¦ï¼Œç›´æ¥è¿™æ ·æ˜¯ä¸è¡Œçš„ï¼š</p> <p>console.log('\u1f004'); // á½†4
è¿™æ ·ï¼Œå¼•æ“ä¼šæŠŠ\u1f004 è§£ææˆå­—ç¬¦\u1f00 å’Œé˜¿æ‹‰ä¼¯æ•°å­— 4 ç»„æˆçš„å­—ç¬¦ä¸²ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨{}å°†ç¼–ç åŒ…å«èµ·æ¥ï¼Œè¿™æ ·å°±å¯ä»¥äº†ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>console.log('\u{1f004}'); // ğŸ€„
</code></pre></div><h2 id="ä»£ç†å¯¹ï¼ˆsurrogate-pairï¼‰"><a href="#ä»£ç†å¯¹ï¼ˆsurrogate-pairï¼‰" class="header-anchor">#</a> ä»£ç†å¯¹ï¼ˆsurrogate pairï¼‰</h2> <p>ä¸ºåŒºåˆ« BMP æ¥è¡¨ç¤ºè¾…åŠ©å¹³é¢ï¼ŒUnicode å¼•å…¥ä»£ç†å¯¹(surrogate pair)ï¼Œè§„å®šç”¨ 2 ä¸ª 16 ä½ç¼–ç å•å…ƒæ¥è¡¨ç¤ºä¸€ä¸ªç ä½ï¼Œå…·ä½“è§„åˆ™æ˜¯å°†ä¸€ä¸ªå­—ç¬¦æŒ‰å¦‚ä¸‹è¡¨ç¤ºï¼š</p> <p>åœ¨ BMP å†…çš„å­—ç¬¦ï¼Œä»ç„¶æŒ‰ç…§ UTF-16 çš„ç¼–ç è§„åˆ™ï¼Œä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºã€‚
å¢è¡¥å­—ç¬¦ä½¿ç”¨ä¸¤ç»„ 16 ä½ç¼–ç æ¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦è§„åˆ™ä¸ºï¼š
é¦–å…ˆå°†å®ƒçš„ç¼–ç å‡å» 0x10000
ç„¶åå†™æˆ yyyy yyyy yyxx xxxx xxxx çš„ 20 ä½äºŒè¿›åˆ¶å½¢å¼
ç„¶åç¼–ç ä¸º 110110yy yyyyyyyy 110111xx xxxxxxxx ä¸€å…± 4 ä¸ªå­—èŠ‚ã€‚
å…¶ä¸­ 110110yyyyyyyyyy å’Œ 110111xxxxxxxxxx å°±æ˜¯ä¸¤ä¸ªä»£ç†å­—ç¬¦ï¼Œå½¢æˆä¸€ç»„ä»£ç†å¯¹ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªä»£ç†å­—ç¬¦çš„èŒƒå›´ä» U+D800 åˆ° U+DBFFï¼Œç¬¬äºŒä¸ªä»£ç†å­—ç¬¦çš„èŒƒå›´ä» U+DC00 åˆ° U+DFFFã€‚</p> <p>å¦å¤–éœ€è¦è¯´æ˜çš„æ˜¯ï¼Œæœ€å¼€å§‹çš„ 2^16 é‚£äº›æ•°æ®ä¸­å¹¶ééƒ½æ˜ å°„æ»¡äº†ã€‚ä» U+D800ï¼ˆ55296ï¼‰ åˆ° U+DFFFï¼ˆ57343ï¼‰å…± 2048 ä¸ªç ä½ï¼Œæ˜¯æ°¸ä¹…ä¿ç•™çš„ï¼Œä¸æ˜ å°„åˆ°ä»»ä½• Unicode å­—ç¬¦ã€‚å®ƒçš„å­˜åœ¨ä¸º UTF-16 æä¾›äº†æ–¹ä¾¿ã€‚</p> <p>ä¸¾ä¾‹æ¥è¯´ï¼Œå­—ç¬¦ ğŸ˜‚ çš„ç ä½æ˜¯ U+1F602(128514)ï¼Œå¤§äº 65535ï¼Œå› æ­¤æ˜¯åæ·»åŠ çš„å­—ç¬¦ã€‚</p> <p>é¦–å…ˆç”¨å®ƒå…ˆå‡å» 65536ï¼Œå¾—åˆ° 62978ï¼Œå¯¹åº”çš„äºŒè¿›åˆ¶æ˜¯ 1111011000000010ã€‚
ç„¶åå·¦è¡¥å…… 0 è‡³ 20 ä½ï¼š00001111011000000010ã€‚
å†ä»ä¸­é—´åˆ‡æ–­æˆä¸Šä¸‹ä¸¤å€¼ï¼š0000111101ï¼ˆ61ï¼‰ å’Œ 1000000010ï¼ˆ514ï¼‰ã€‚
æ·»åŠ  0xD800ï¼ˆ55296ï¼‰åˆ°ä¸Šå€¼ï¼Œä»¥å½¢æˆé«˜ä½ï¼š55296 + 61 = 55357ï¼ˆ0xD83Dï¼‰ã€‚
æ·»åŠ  0xDC00ï¼ˆ56320ï¼‰åˆ°ä¸‹å€¼ï¼Œä»¥å½¢æˆä½ä½ï¼š56320+ 514 = 56834ï¼ˆ0xDE02ï¼‰ã€‚
0xD83D ä¸ 0xDE02 æ„æˆä¸€ä¸ªä»£ç†å¯¹ï¼Œæ¥è¡¨ç¤ºç ä½ U+1F602ã€‚
å¯ä»¥éªŒè¯å¦‚ä¸‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token string">'ğŸ˜‚'</span><span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 55357</span>
<span class="token string">'ğŸ˜‚'</span><span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// 56834</span>
<span class="token string">'\u{1F602}'</span> <span class="token comment">// ğŸ˜‚</span>
<span class="token string">'\uD83D\uDE02'</span> <span class="token comment">// </span>
ğŸ˜‚<span class="token string">'\u{1F602}'</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'\uD83D'</span> <span class="token comment">// true</span>
</code></pre></div><p>æ­¤æ—¶ï¼Œæƒ³å¿…ä½ ä¹Ÿæ˜ç™½äº†æ–‡ç« å¼€å¤´çš„é—®é¢˜äº†ï¼š'ğŸ˜‚'.length ä¹‹æ‰€ä»¥ä¸º 2ï¼Œæ˜¯å› ä¸º JS è‡³ä»Šä»ç„¶ä½¿ç”¨ UCS-2 é‚£ç§ 16 è¿›åˆ¶è¯»å–æ–¹å¼ã€‚</p> <h2 id="å®ç°-getcodepoint"><a href="#å®ç°-getcodepoint" class="header-anchor">#</a> å®ç° getCodePoint</h2> <p>ç†è§£äº†ä»£ç†å¯¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ charCodeAt å®ç° getCodePoint äº†ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>function getCodePoint(str, idx = 0) {
  const code = str.charCodeAt(idx);
  if(code &gt;= 0xD800 &amp;&amp; code &lt;= 0xDBFF) {
    const high = code;
    const low = str.charCodeAt(idx + 1);
    return ((high - 0xD800) * 0x400) +
      (low - 0xDC00) + 0x10000;
  }
  return code;
}

console.log(getCodePoint('ä¸­')); // 20013
console.log(getCodePoint('ğŸ€„')); // 126980
</code></pre></div><p>åŒæ ·åœ°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ fromCharCode å®ç° fromCodePoint:</p> <div class="language- extra-class"><pre class="language-text"><code>function fromCodePoint(...codePoints) {
  let str = '';
  for(let i = 0; i &lt; codePoints.length; i++) {
    let codePoint = codePoints[i];
    if(codePoint &lt;= 0xFFFF) {
      str += String.fromCharCode(codePoint);
    } else {
      codePoint -= 0x10000;
      const high = (codePoint &gt;&gt; 10) + 0xD800;
      const low = (codePoint % 0x400) + 0xDC00;
      str += String.fromCharCode(high) + String.fromCharCode(low);
    }
  }
  return str;
}

console.log(fromCodePoint(126980, 20013)); // ğŸ€„ä¸­
</code></pre></div><p>æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥ç”¨ä¸Šé¢è¿™æ ·çš„æ€è·¯æ¥å®ç°æ—©æœŸæµè§ˆå™¨ä¸‹çš„ polyfillã€‚å®é™…ä¸Š MDN å®˜æ–¹å¯¹<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/codePointAt" target="_blank" rel="noopener noreferrer">codePointAt<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>å’Œ<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/String/fromCodePoint" target="_blank" rel="noopener noreferrer">fromCodePoint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>çš„è¯´æ˜ä¸­ï¼Œå°±æŒ‰ç…§ä¸Šé¢çš„æ€è·¯æä¾›äº†å¯¹åº”çš„ polyfill æ–¹æ³•ã€‚</p> <h2 id="getcodepointcount"><a href="#getcodepointcount" class="header-anchor">#</a> getCodePointCount</h2> <p>JavaScript å­—ç¬¦ä¸²çš„ length åªèƒ½è·å¾— UTF-16 å­—ç¬¦çš„ä¸ªæ•°ï¼Œæ‰€ä»¥å‰é¢çœ‹åˆ°çš„ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>console.log('ğŸ€„'.length); // å­—ç¬¦ä¸²é•¿åº¦ä¸º2
</code></pre></div><p>è¦è·å¾— Unicode å­—ç¬¦æ•°ï¼Œæœ‰å‡ ä¸ªåŠæ³•ï¼Œæ¯”å¦‚ä½¿ç”¨ spread æ“ä½œæ˜¯å¯ä»¥æ”¯æŒ Unicode å­—ç¬¦ä¸²è½¬æ•°ç»„çš„ï¼Œæ‰€ä»¥ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>function getCodePointCount(str) {
  return [...str].length;
}
console.log(getCodePointCount('ğŸ‘«ä¸­'));
æˆ–è€…ä½¿ç”¨å¸¦æœ‰uæè¿°ç¬¦çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š

function getCodePointCount(str) {
  let result = str.match(/./gu);
  return result ? result.length : 0;
}
console.log(getCodePointCount('ğŸ‘«ä¸­'));
</code></pre></div><h2 id="æ‰©å±•"><a href="#æ‰©å±•" class="header-anchor">#</a> æ‰©å±•</h2> <p>Unicode ç ä½ä½¿ç”¨å›ºå®šçš„ 4 ä¸ªå­—èŠ‚æ¥ç¼–ç å¢è¡¥å­—ç¬¦ï¼Œè€Œæ—©æœŸï¼ŒUTF-8 ç¼–ç åˆ™é‡‡ç”¨å¯å˜çš„ 1~6 ä¸ªå­—èŠ‚æ¥ç¼–ç  Unicode å­—ç¬¦ã€‚</p> <p>UTF-8 ç¼–ç æ–¹å¼å¦‚ä¸‹ï¼š</p> <table><thead><tr><th>å­—èŠ‚</th> <th>èµ·å§‹</th> <th>ç»ˆæ­¢</th> <th>byte1</th> <th>byte2</th> <th>byte3</th> <th>byte4</th> <th>byte5</th> <th>byte6</th></tr></thead> <tbody><tr><td>1</td> <td>U+0000</td> <td>U+007F</td> <td>0xxxxxxx</td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>2</td> <td>U+0080</td> <td>U+07FF</td> <td>110xxxxx</td> <td>10xxxxxx</td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>3</td> <td>U+0800</td> <td>U+FFFF</td> <td>1110xxxx</td> <td>10xxxxxx</td> <td>10xxxxxx</td> <td></td> <td></td> <td></td></tr> <tr><td>4</td> <td>U+10000</td> <td>U+1FFFFF</td> <td>11110xxx</td> <td>10xxxxxx</td> <td></td> <td>10xxxxxx</td> <td>10xxxxxx</td> <td></td></tr> <tr><td>5</td> <td>U+200000</td> <td>U+3FFFFFF</td> <td>111110xx</td> <td>10xxxxxx</td> <td>10xxxxxx</td> <td>10xxxxxx</td> <td>10xxxxxx</td> <td></td></tr> <tr><td>6</td> <td>U+4000000</td> <td>U+7FFFFFFF</td> <td>1111110x</td> <td>10xxxxxx</td> <td>10xxxxxx</td> <td>10xxxxxx</td> <td>10xxxxxx</td> <td>10xxxxxx</td></tr></tbody></table> <p>åœ¨æµè§ˆå™¨çš„encodeURIComponentå’ŒNodeçš„Bufferé»˜è®¤é‡‡ç”¨UTF-8ç¼–ç ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>console.log(encodeURIComponent('ä¸­')); // %E4%B8%AD
const buffer = new Buffer('ä¸­');
console.log(buffer); // &lt;Buffer e4 b8 ad&gt;
</code></pre></div><p>è¿™é‡Œçš„E4ã€B8ã€ADå°±æ˜¯ä¸‰ä¸ªå­—èŠ‚çš„åå…­è¿›ç¼–ç ï¼Œæˆ‘ä»¬è¯•ç€è½¬ä¸€ä¸‹ï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>const byte1 = parseInt('E4', 16); // 228
const byte2 = parseInt('B8', 16); // 184
const byte3 = parseInt('AD', 16); // 173

const codePoint = (byte1 &amp; 0xf) &lt;&lt; 12 | (byte2 &amp; 0x3f) &lt;&lt; 6 | (byte3 &amp; 0x3f);

console.log(codePoint); // 20013
</code></pre></div><p>æˆ‘ä»¬å°†ä¸‰ä¸ªå­—èŠ‚çš„æ§åˆ¶ç 1110ã€10ã€10åˆ†åˆ«å»æ‰ï¼Œç„¶åå°†å®ƒä»¬æŒ‰ç…§ä»é«˜ä½åˆ°ä½ä½çš„é¡ºåºæ‹¼æ¥èµ·æ¥ï¼Œæ­£å¥½å°±å¾—åˆ°'ä¸­'çš„ç ä½20013ã€‚</p> <p>æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ©ç”¨UTF-8ç¼–ç è§„åˆ™ï¼Œå†™å¦ä¸€ä¸ªç‰ˆæœ¬çš„é€šç”¨æ–¹æ³•æ¥å®ç°getCodePointï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>function getCodePoint(char) {
  const code = char.charCodeAt(0);
  if(code &lt;= 0x7f) return code;
  const bytes = encodeURIComponent(char)
    .slice(1)
    .split('%')
    .map(c =&gt; parseInt(c, 16));
  
  let ret = 0;
  const len = bytes.length;
  for(let i = 0; i &lt; len; i++) {
    if(i === 0) {
      ret |= (bytes[i] &amp; 0xf) &lt;&lt; 6 * (len - i - 1);
    } else {
      ret |= (bytes[i] &amp; 0x3f) &lt;&lt; 6 * (len - i - 1);
    }
  }
  return ret;
}

console.log(getCodePoint('ä¸­')); // 20013
console.log(getCodePoint('ğŸ€„')); // 126980
</code></pre></div><p>é‚£ä¹ˆåŒæ ·ï¼Œæˆ‘ä»¬å¯ä»¥å®ç°fromCodePointï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>function fromCodePoint(point) {
  if(point &lt;= 0xffff) return String.fromCharCode(point);
  const bytes = [];
  bytes.unshift(point &amp; 0x3f | 0x80);
  point &gt;&gt;&gt;= 6;
  bytes.unshift(point &amp; 0x3f | 0x80);
  point &gt;&gt;&gt;= 6;
  bytes.unshift(point &amp; 0x3f | 0x80);
  point &gt;&gt;&gt;= 6;
  if(point &lt; 0x1FFFFF) {
    bytes.unshift(point &amp; 0x7 | 0xf0);
  } else if(point &lt; 0x3FFFFFF) {
    bytes.unshift(point &amp; 0x3f | 0x80);
    point &gt;&gt;&gt;= 6;
    bytes.unshift(point &amp; 0x3 | 0xf8);
  } else {
    bytes.unshift(point &amp; 0x3f | 0x80);
    point &gt;&gt;&gt;= 6;
    bytes.unshift(point &amp; 0x3f | 0x80);
    point &gt;&gt;&gt;= 6;
    bytes.unshift(point &amp; 0x1 | 0xfc);
  }
  const code = '%' + bytes.map(b =&gt; b.toString(16)).join('%');
  return decodeURIComponent(code);
}

console.log(fromCodePoint(126980)); // ğŸ€„
</code></pre></div><h2 id="æ–‡çŒ®"><a href="#æ–‡çŒ®" class="header-anchor">#</a> æ–‡çŒ®</h2> <p>æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ JS è§„èŒƒã€ŠEcma-262ã€‹ å¯¹æ­¤çš„æè¿°ï¼š</p> <blockquote><p>The String type is the set of all ordered sequences of zero or more 16-bit unsigned integer values (â€œelementsâ€) up to amaximum length of 25^3 - 1 elements. The String type is generally used to represent textual data in a running ECMAScript program, in which case each element in the String is treated as a UTF-16 code unit value. Each element is regarded as occupying a position within the sequence. These positions are indexed with nonnegative integers. The first element (if any) is at index 0, the next element (if any) at index 1, and so on. The length of a String is the number of elements (i.e., 16-bit values) within it. The empty String has length zero and therefore contains no elements.</p></blockquote> <blockquote><p>ECMAScript operations that do not interpret String contents apply no further semantics. Operations that do interpret String values treat each element as a single UTF-16 code unit. However, ECMAScript does not restrict the value of or relationships between these code units, so operations that further interpret String contents as sequences of Unicode code points encoded in UTF-16 must account for ill-formed subsequences. Such operations apply special treatment to every code unit with a numeric value in the inclusive range 0xD800 to 0xDBFF (defined by the Unicode Standard as a leading surrogate, or more formally as a high-surrogate code unit) and every code unit with a numeric value in the inclusive range 0xDC00 to 0xDFFF (defined as a trailing surrogate, or more formally as a low-surrogate code unit) using the following rules:</p></blockquote> <blockquote><p>A code unit that is not a leading surrogate and not a trailing surrogate is interpreted as a code point with the same value.</p></blockquote> <blockquote><p>A sequence of two code units, where the first code unit c1 is a leading surrogate and the second code unit c2 a trailing surrogate, is a surrogate pair and is interpreted as a code point with the value (c1 - 0xD800) Ã— 0x400 + (c2 - 0xDC00) + 0x10000. (See 10.1.2)</p></blockquote> <blockquote><p>A code unit that is a leading surrogate or trailing surrogate, but is not part of a surrogate pair, is interpreted as a code point with the same value.</p></blockquote> <p>ç¿»è¯‘å¦‚ä¸‹ï¼š</p> <blockquote><p>å­—ç¬¦ä¸²ç±»å‹æ˜¯é›¶ä¸ªæˆ–å¤šä¸ª 16 ä½æ— ç¬¦å·æ•´æ•°å€¼ï¼ˆâ€œå…ƒç´ â€ï¼‰çš„æ‰€æœ‰æœ‰åºåºåˆ—çš„é›†åˆï¼Œæœ€å¤§é•¿åº¦ä¸º 25^3-1 ä¸ªå…ƒç´ ã€‚å­—ç¬¦ä¸²ç±»å‹é€šå¸¸ç”¨äºè¡¨ç¤ºæ­£åœ¨è¿è¡Œçš„ ECMAScript ç¨‹åºä¸­çš„æ–‡æœ¬æ•°æ®ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½è¢«è§†ä¸º UTF-16 ä»£ç å•å…ƒå€¼ã€‚ æ¯ä¸ªå…ƒç´ è¢«è®¤ä¸ºåœ¨åºåˆ—ä¸­å æ®ä¸€ä¸ªä½ç½®ã€‚è¿™äº›ä½ç½®ç”¨éè´Ÿæ•´æ•°ç´¢å¼•ã€‚ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆå¦‚æœæœ‰ï¼‰ä½äºç´¢å¼• 0ï¼Œä¸‹ä¸€ä¸ªå…ƒç´ ï¼ˆå¦‚æœæœ‰ï¼‰ä½äºç´¢å¼• 1ï¼Œä¾æ­¤ç±»æ¨ã€‚å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯å…¶ä¸­çš„å…ƒç´ æ•°ï¼ˆå³ 16 ä½å€¼ï¼‰ã€‚ç©ºå­—ç¬¦ä¸²çš„é•¿åº¦ä¸ºé›¶ï¼Œå› æ­¤ä¸åŒ…å«ä»»ä½•å…ƒç´ ã€‚</p></blockquote> <blockquote><p>ä¸è§£é‡Šå­—ç¬¦ä¸²å†…å®¹çš„ ECMAScript æ“ä½œä¸å†åº”ç”¨ä»»ä½•è¯­ä¹‰ã€‚è§£é‡Šå­—ç¬¦ä¸²å€¼çš„æ“ä½œå°†æ¯ä¸ªå…ƒç´ è§†ä¸ºå•ä¸ª UTF-16 ä»£ç å•å…ƒã€‚ä½†æ˜¯ï¼ŒECMAScript å¹¶ä¸é™åˆ¶è¿™äº›ä»£ç å•å…ƒçš„å€¼æˆ–å®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œå› æ­¤ï¼Œå°† String å†…å®¹è¿›ä¸€æ­¥è§£é‡Šä¸º UTF-16 ç¼–ç çš„ Unicode ä»£ç ç‚¹åºåˆ—çš„æ“ä½œå¿…é¡»è€ƒè™‘æ ¼å¼é”™è¯¯çš„å­åºåˆ—ã€‚æ­¤ç±»æ“ä½œä¼šå¯¹æ•°å­—å€¼åœ¨ 0xD800 åˆ° 0xDBFFï¼ˆç”± Unicode æ ‡å‡†å®šä¹‰ä¸ºé¢†å…ˆä»£ç†ï¼Œæˆ–æ›´æ­£å¼åœ°ä½œä¸ºé«˜ä»£ç†ä»£ç å•å…ƒï¼‰èŒƒå›´å†…çš„æ¯ä¸ªä»£ç å•å…ƒå’Œæ¯ä¸ªå…·æœ‰æ•°å­—å€¼çš„ä»£ç å•å…ƒè¿›è¡Œç‰¹æ®Šå¤„ç†ã€‚ä½¿ç”¨ä»¥ä¸‹è§„åˆ™åœ¨ 0xDC00 åˆ° 0xDFFFï¼ˆåŒ…æ‹¬å°¾éšä»£ç†ï¼Œæˆ–æ›´æ­£å¼åœ°å®šä¹‰ä¸ºä½ä»£ç†ä»£ç å•å…ƒï¼‰çš„èŒƒå›´å†…ï¼š</p></blockquote> <blockquote><p>ä¸æ˜¯å‰å¯¼ä»£ç†ä¹Ÿä¸æ˜¯å°¾éšä»£ç†çš„ä»£ç å•å…ƒè¢«è§£é‡Šä¸ºå…·æœ‰ç›¸åŒå€¼çš„ä»£ç ç‚¹ã€‚</p></blockquote> <blockquote><p>ä¸¤ä¸ªä»£ç å•å…ƒçš„åºåˆ—ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªä»£ç å•å…ƒ c1 æ˜¯å‰å¯¼ä»£ç†ï¼Œç¬¬äºŒä¸ªä»£ç å•å…ƒ c2 æ˜¯å°¾éšä»£ç†ï¼Œæ˜¯ä¸€ä¸ªä»£ç†å¯¹ï¼Œå¹¶è¢«è§£é‡Šä¸ºå€¼ï¼ˆc1-0xD800ï¼‰Ã—0x400 +ï¼ˆ c2-0xDC00ï¼‰+ 0x10000ã€‚ ï¼ˆè¯·å‚è§ 10.1.2ï¼‰</p></blockquote> <blockquote><p>ä½œä¸ºå‰å¯¼ä»£ç†æˆ–å°¾éšä»£ç†ä½†ä¸å±äºä»£ç†å¯¹çš„ä»£ç å•å…ƒï¼Œå°†è¢«è§£é‡Šä¸ºå…·æœ‰ç›¸åŒå€¼çš„ä»£ç ç‚¹ã€‚</p></blockquote> <h2 id="surrogate-pair"><a href="#surrogate-pair" class="header-anchor">#</a> surrogate pair</h2> <p>è¿™é‡Œé¢æœ‰ä¸¤ä¸ªå¾ˆé‡è¦çš„æœ¯è¯­ï¼š</p> <ul><li>code point: æŒ‡ Unicode æ ‡å‡†é‡Œâ€œå­—ç¬¦â€çš„ç¼–å·ï¼Œç›®å‰ Unicode ä½¿ç”¨äº† 0 ~ 0x10FFFF çš„ç¼–ç èŒƒå›´ã€‚è¿™é‡Œå­—ç¬¦äºŒå­—åŠ äº†å¼•å·ï¼Œæ˜¯å› ä¸ºè¿™ä¸ªæ¦‚å¿µå¾ˆæ··æ·†ï¼Œåé¢ä¼šå†è®²è¿°ã€‚</li> <li>code unit: æŒ‡æŸç§ Unicode ç¼–ç æ–¹å¼é‡Œç¼–ç ä¸€ä¸ª code point éœ€è¦çš„æœ€å°‘å­—èŠ‚æ•°ï¼Œæ¯”å¦‚ UTF-8 éœ€è¦æœ€å°‘ä¸€ä¸ªå­—èŠ‚ï¼ŒUTF-16 æœ€å°‘ä¸¤ä¸ªå­—èŠ‚ï¼ŒUCS-2 ä¸¤ä¸ªå­—èŠ‚ï¼ŒUCS-4 å’Œ UTF-32 å››ä¸ªå­—èŠ‚ï¼Œåé¢ä¸‰ä¸ªæ˜¯å®šé•¿ç¼–ç ã€‚</li></ul> <p>æ—©æœŸçš„æ—¶å€™ï¼ŒUnicode åªç”¨åˆ°äº† 0~0xFFFF èŒƒå›´çš„æ•°å­—ç¼–ç ï¼Œè¿™å°±æ˜¯ BMP å­—ç¬¦é›†ï¼ŒUCS-2 ç¼–ç ï¼Œå¾ˆå¤šè¯­è¨€å°±ç”¨ 2 bytes æ¥è¡¨ç¤º wchar_t æˆ–è€… charï¼Œå…¸å‹çš„ä¾‹å­æ˜¯ C/C++/Javaã€‚ä½†åæ¥ Unicode ç»„ç»‡èƒ¡æçæå±…ç„¶ç”¨åˆ°äº†è¶…è¿‡è¿™ä¸ªèŒƒå›´çš„æ•°å­—ï¼Œäºæ˜¯å°±å‡ºæ¥ surrogate pair çš„æ¦‚å¿µäº†ã€‚</p> <p>Surrogate pair æ˜¯ä¸“é—¨ç”¨äº UTF-16 çš„ï¼Œä»¥å‘åå…¼å®¹ UCS-2ï¼Œåšæ³•æ˜¯å– UCS-2 èŒƒå›´é‡Œçš„ 0xD800~0xDBFF(ç§°ä¸º high surrogates) å’Œ 0xDC00~0xDFFF(ç§°ä¸º low surrogates) çš„ code pointï¼Œä¸€ä¸ª high surrogate æ¥ä¸€ä¸ª low surrogate æ‹¼æˆå››ä¸ªå­—èŠ‚è¡¨ç¤ºè¶…å‡º BMP çš„å­—ç¬¦ï¼Œä¸¤ä¸ª surrogate range éƒ½æ˜¯ 1024 ä¸ª code pointï¼Œæ‰€ä»¥ surrogate pair å¯ä»¥è¡¨è¾¾ 1024 x 1024 = 1048576 = 0x100000 ä¸ªå­—ç¬¦ï¼Œè¿™å°±æ˜¯ Unicode çš„å­—ç¬¦é›†èŒƒå›´ä¸Šé™æ˜¯ 0x10FFFF çš„åŸå› ï¼Œä¸ºäº†ç…§é¡¾ UTF-16 ä»¥åŠä¸€å¤§å †é‡‡ç”¨äº† UTF-16 çš„è¯­è¨€ã€æ“ä½œç³»ç»Ÿï¼ˆæ¯”å¦‚ Windowsï¼‰ï¼Œè¿™ä¸ªä¸Šé™ä¸èƒ½çªç ´ï¼Œå“ªæ€• UTF-8 å’Œ UTF-32 å¯ä»¥ç¼–ç æ›´å¤§çš„èŒƒå›´ï¼Œå®åœ¨æ˜¯å†å²æ‚²å‰§ï¼</p> <p>å…¶ä¸­æåˆ°äº†ç å…ƒï¼ˆcode unitï¼‰ï¼Œæ˜¯æŒ‡æœ€å­˜å‚¨çš„æœ€å°å•ä½ï¼Œè¿™é‡Œå³ 2 ä¸ªå­—èŠ‚ã€‚</p> <p>å‰æ–‡è®¨è®ºè¿‡ï¼Œå¤§äº 65535 çš„ç ä½ä¼šç”Ÿæˆä¸€ä¸ªä»£ç†å¯¹ï¼ˆæ¯”å¦‚ ğŸ˜‚ çš„ç ä½æ˜¯ U+1F602ï¼Œä»£ç†å¯¹æ˜¯ U+D83D å’Œ U+DE02ï¼‰ï¼Œå³ç”¨äº† 2 ä¸ªç å…ƒã€‚ä¸Šè¿° JS è§„èŒƒä¸­æ˜ç¡®å¾—æŒ‡å‡ºï¼šâ€œæ¯ä¸ªå…ƒç´ éƒ½è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªå•ç‹¬çš„ UTF-16 ç å…ƒâ€ã€‚å› æ­¤ ğŸ˜‚ ç¬¦å·ä¸º 2ã€‚</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/static-website/interview/3.html" class="prev">
        å…³äºBigInt
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/static-website/assets/js/app.8f4c87ad.js" defer></script><script src="/static-website/assets/js/2.1f517c06.js" defer></script><script src="/static-website/assets/js/13.85a9c570.js" defer></script>
  </body>
</html>
